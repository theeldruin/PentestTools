#!/bin/bash

#Este script recebe um arquivo com os hosts a serem varridos e testados
#Exemplo
#	echo bugcrowd.com >> targets.txt	
#	echo hackerone.com >> targets.txt
#	fasthunt.sh targets.txt	

rnd=$(date "+%T")

echo "Resolvendo alvos..."
for target in $(cat $1 | httprobe | sort | uro)
do
	echo "---> $target"
	echo "------> Crawlilng"
	gospider -s $target -c 5 -d 5 -H "X-Bug-Hunter: Eldruin" --blacklist ".(jpg|jpeg|js|eot|gif|css|tif|tiff|png|ttf|woff|woff2|ico|pdf|svg|txt)" --other-source | grep -e code-200 | awk '{print $5}' | grep = >> temp-$rnd.txt
	paramspider -d $target -e jpg,jpeg,js,eot,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt | grep = >> temp-$rnd.txt
	gau $target --subs --blacklist jpg,jpeg,js,eot,gif,css,tif,tiff,png,ttf,woff,woff2,ico,pdf,svg,txt | grep = >> temp-$rnd.txt 
	cat temp-$rnd.txt | uro | Gxss -p eldruin >> dalfox-$rnd.txt
done

echo "------> Testando"
cat dalfox-$rnd.txt | sort --random-sort | dalfox pipe --only-poc=v -S -H "X-Bug-Hunter: Eldruin" -w 1 | notify -silent

rm temp-$rnd.txt
rm dalfox-$rnd.txt