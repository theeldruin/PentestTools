#!/bin/bash

declare alvo=$1

BLACK='\033[0;30m'
RED='\033[0;31m'
GREEN='\033[0;32m'
BO='\033[0;33m'
BLUE='\033[0;34m'
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
LGRAY='\033[0;37m'
DGRAY='\033[1;30m'
LRED='\033[1;31m'
LGREEN='\033[1;32m'
YELLOW='\033[1;33m'
LBLUE='\033[1;34m'
LPURPLE='\033[1;35m'
LCYAN='\033[1;36m'
WHITE='\033[1;37m'
NC='\033[0m'

#--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	### Enumerando Subdominios
	echo -e "${PURPLE}---> Enumerando Subdominios"
	echo -e "------> Running Subfinder"
	echo $alvo | subfinder -silent >> /tmp/temp.txt

	#echo -e "------> Running Sublist3r"
	#touch /tmp/sub.txt
	#sublist3r -d $alvo -o /tmp/sub.txt 2>/dev/null 1>/dev/null
	#cat /tmp/sub.txt >> /tmp/temp.txt

	echo -e "------> Running Gauplus"
	echo $alvo | gauplus -subs | sort | uro >> /tmp/gau.txt
	cat /tmp/gau.txt | sort | uro >> /tmp/links.txt
	cat /tmp/gau.txt | cut -d "/" -f 1,2,3 | sort | uro >> /tmp/temp.txt

	echo -e "------> Running OWASP Amass"
	amass enum -brute -silent -d $alvo >> /tmp/temp.txt
	
	echo -e "------> Running DNSX"
	dnsx -silent -retry 3 -cname -l amass enum -brute -silent -d $alvo >> /tmp/temp.txt
	
	echo -e "------> Running Chaos"
	chaos -silent -d $alvo >> /tmp/temp.txt
	
	echo -e "------> Running Assetfinder"
	echo $alvo | assetfinder --subs-only | uniq >> /tmp/temp.txt
	
	echo -e "------> Verificando crt.sh"
	curl -s "https://crt.sh/?q=%25.$alvo" | grep "$alvo" | egrep -v "&|%" | sed 's/<TD>//g' | sed 's/<\/TD>//g' | sed 's/ //g' | sed 's/\*\.//g' | sed 's/<BR>/\n/g' | sort | uniq >> /tmp/temp.txt
	
	
	### Filtrando subdominios encontrados e ativos
	echo -e "------> Verificando links que ainda est√£o ativos"
	cat /tmp/temp.txt | tr '[:upper:]' '[:lower:]' | grep $alvo | sort | anew | httpx -silent -retries 2 -fc 404 
	
	rm /tmp/temp.txt
	